[11, 15, 16, 12, 13, 14, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96]
#INFO: **** input file is /home/amychoi7/git/temp/03_dumpInt.py ****

"""
Dump integrals from chkfile using pyscf.

Author: Seunghoon Lee, Jan 17, 2022
Edited: Inyoung  Choi, Jan 16, 2024
Edited2: Inyoung Choi, May 02, 2024

"""

import numpy as np
from tools_io import dumpERIs
from pyscf import gto, scf, dft, ao2mo
# FCI: Full Config Integral
# ASP: adiabatic state preparation
import sys
#==================================================================
# TODO 
#==================================================================
# model = 'feIIIfeII_13o17eR_lunoloc' # FIXME
# norb = 13 # FIXME
# nelec = [9,8] # FIXME               # [ # of a, # of b ]

# FIXME
# header =""" &FCI NORB=13,NELEC=17,MS2=0,
#   ORBSYM=1,1,1,1,1,1,1,1,1,1,1,1,1,
#   ISYM=1,
#  &END
# """

model = 'feIIIfeII_22o35e_lunocloc'
norb = 22
nelec = [18,17]
header =""" &FCI NORB=22,NELEC=35,MS2=0,
  ORBSYM=1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  ISYM=1,
 &END
"""


# mychkfile_loc = '/home/amychoi7/git/pyxray2/data/fe2s2/' + 'feIIIfeII_lunocloc.h5'
mychkfile_loc = 'feIIIfeII_lunocloc.h5'
myFCIDUMPfile = 'FCIDUMP_lunocloc_22o35e'


act_idx = [] # MO indexes of active space (in jmol order)
# lunocloc
# act1 = [14,16,17] # feR 2p
# act2 = [89,90,91,93,96] # feL 3d
# act4 = [92,94,95,97,98] # feR 3d

# lunoloc
# act1 = [12,13,15] # feR 2p
# act2 = [90,92,93,95,89] # feL 3d
# act4 = [98,91,94,96,97] # feR 3d

# jmol order; base=1
act0 = [11, 15, 16] # fe0 2p
act1 = [12, 13, 14] # fe5 2p
act2 = [81, 82, 83, 84, 85] # fe0 3d
act3 = [86, 87, 88, 89, 90, 91] # Sc 3
act4 = [92, 93, 94, 95, 96] # fe53
# sp_sigma_terminal = [79,80,97,98] # feL 3d

act_idx = act0 + act1 + act2 + act3 + act4 
# + sp_sigma_terminal
print(act_idx)

#sys.exit()

atom = """Fe     0.000000    0.000000    0.000000
S      1.803282    1.552038   -0.015832
S      0.179063   -1.428559    1.984882
S      0.156011   -1.489475   -1.887889
S     -1.799241    1.534638   -0.026753
Fe     0.000000    2.913846    0.000000
S      0.160778    4.414680   -1.934049
S     -0.108071    4.429884    1.936840
C     -0.912210   -2.963849   -1.242889
H     -1.989184   -2.859451   -1.562462
H     -0.525883   -3.945369   -1.615675
H     -0.867825   -2.932516   -0.120549
C      1.844709   -2.175921    1.378192
H      2.638850   -1.403540    1.474465
H      2.132068   -3.090314    1.972928
H      1.736050   -2.422125    0.300567
C      1.648897    5.101058    1.488302
H      1.607332    5.507634    0.450386
H      1.973504    5.885932    2.215354
H      2.354855    4.241919    1.489893
C     -1.554571    5.164995   -1.500913
H     -1.840202    5.975229   -2.224677
H     -2.318714    4.341993   -1.513295
H     -1.506866    5.565668   -0.459671
"""

charge = -3
twos = 9

ano_fe = gto.basis.parse('''
        Fe    S
        4316265.                     0.00015003            -0.00004622             0.00001710            -0.00000353             0.00000423
         646342.4                    0.00043597            -0.00013445             0.00004975            -0.00001026             0.00001234
         147089.7                    0.00120365            -0.00037184             0.00013758            -0.00002838             0.00003400
          41661.52                   0.00312635            -0.00096889             0.00035879            -0.00007397             0.00008934
          13590.77                   0.00814591            -0.00253948             0.00094021            -0.00019410             0.00023098
           4905.750                  0.02133892            -0.00673001             0.00249860            -0.00051496             0.00062709
           1912.746                  0.05470838            -0.01768160             0.00657103            -0.00135801             0.00160135
            792.6043                 0.12845394            -0.04375410             0.01640473            -0.00338297             0.00416181
            344.8065                 0.25203824            -0.09601111             0.03637157            -0.00754121             0.00877359
            155.8999                 0.35484986            -0.16998599             0.06664937            -0.01380066             0.01738346
             72.23091                0.27043078            -0.18456376             0.07553682            -0.01588736             0.01718943
             32.72506                0.06476086             0.05826300            -0.02586806             0.00570363            -0.00196602
             15.66762               -0.00110466             0.52163758            -0.31230230             0.06807261            -0.09285258
              7.503483               0.00184555             0.49331062            -0.44997654             0.10526256            -0.11350600
              3.312223              -0.00085600             0.08632670             0.14773374            -0.04562463             0.01812457
              1.558471               0.00037119            -0.00285017             0.72995709            -0.21341607             0.41268036
              0.683914              -0.00014687             0.00165569             0.38458847            -0.24353659             0.10339104
              0.146757               0.00006097            -0.00049176             0.01582890             0.34358715            -0.89083095
              0.070583              -0.00005789             0.00047608            -0.00949537             0.46401833            -0.80961283
              0.031449               0.00002770            -0.00022820             0.00308038             0.34688312             1.52308946
              0.012580              -0.00000722             0.00006297            -0.00100526             0.01225841             0.09142619
        Fe    P
           7721.489                  0.00035287            -0.00012803            -0.00013663             0.00003845
           1829.126                  0.00196928            -0.00071517            -0.00077790             0.00021618
            593.6280                 0.00961737            -0.00352108            -0.00375042             0.00105697
            226.2054                 0.03724273            -0.01379065            -0.01516741             0.00418424
             95.26145                0.11332297            -0.04331452            -0.04705206             0.01307817
             42.85920                0.25335172            -0.10061222            -0.11529630             0.03095510
             20.04971                0.38104215            -0.16161377            -0.17017078             0.04896849
              9.620885               0.30703250            -0.11214083            -0.13220830             0.03516849
              4.541371               0.08654534             0.18501865             0.53797582            -0.08338612
              2.113500               0.00359924             0.47893080             0.61199701            -0.17709305
              0.947201               0.00144059             0.40514792            -0.64465308            -0.11907766
              0.391243              -0.00029901             0.09872160            -0.61225551             0.12237413
              0.156497               0.00020351            -0.00148592             0.10798966             0.54998130
              0.062599              -0.00009626             0.00222977             0.37358045             0.39970337
              0.025040               0.00002881            -0.00072259             0.18782870             0.08298275
        Fe    D
            217.3688                 0.00096699            -0.00098327
             64.99976                0.00793294            -0.00789694
             24.77314                0.03548314            -0.03644790
             10.43614                0.10769519            -0.10760712
              4.679653               0.22555488            -0.26104796
              2.125622               0.31942979            -0.29085509
              0.945242               0.32354390             0.01254821
              0.402685               0.24338270             0.40386046
              0.156651               0.10680569             0.38672483
              0.062660               0.02052711             0.24394500
        Fe    F
             11.2749                 0.03802196
              4.4690                 0.25501829
              1.7713                 0.50897998
               .7021                 0.35473516
               .2783                 0.12763297
               .1103                 0.01946831
        ''')
ano_s = gto.basis.parse('''
        S    S
         346348.23                   0.00029092            -0.00008101             0.00002280            -0.00002342
          49391.146                  0.00094665            -0.00026388             0.00007421            -0.00007637
          14610.990                  0.00211923            -0.00059263             0.00016719            -0.00017089
           5187.2095                 0.00602161            -0.00168762             0.00047372            -0.00048999
           1980.9676                 0.01659726            -0.00470357             0.00133106            -0.00135293
            784.63139                0.04683989            -0.01350607             0.00379801            -0.00392820
            317.32779                0.12242581            -0.03711959             0.01058108            -0.01067637
            130.01976                0.27022435            -0.09114723             0.02601970            -0.02661813
             53.738208               0.40541657            -0.17780418             0.05279001            -0.05183027
             22.345896               0.25571527            -0.17069592             0.05191878            -0.05362245
              9.3332512              0.02671693             0.17423163            -0.05692828             0.07080611
              3.9111868              0.00390332             0.63283682            -0.29095190             0.28624981
              1.6432066             -0.00204189             0.35886635            -0.31632828             0.49626307
               .69174560             0.00149034            -0.00096444             0.29309938            -1.07109282
               .29167360            -0.00062107             0.00659942             0.66787427            -0.79207470
               .12314410             0.00044167            -0.00522266             0.28725199             1.19881853
               .04925760            -0.00000324             0.00029385             0.01516887             0.32475750
        S    P
           1129.1269                 0.00090586            -0.00022454             0.00021481
            274.03515                0.00600033            -0.00148850             0.00137868
             97.402584               0.02531166            -0.00634942             0.00612706
             38.085518               0.09198941            -0.02344282             0.02170457
             15.471033               0.24165028            -0.06370257             0.06243734
              6.4056590              0.41029096            -0.11197083             0.10108619
              2.6812828              0.35219287            -0.10347278             0.11708231
              1.1300050              0.08281645             0.10903888            -0.16261828
               .47839950             0.00009280             0.41838741            -0.66461283
               .20318050            -0.00223897             0.43694091            -0.00256719
               .08649230            -0.00131050             0.18619701             0.71028173
               .03459690            -0.00022092             0.02837119             0.32134414
        S    D
              3.0053679              0.03581500
              1.2172976              0.16734186
               .49305560             0.57605251
               .19970780             0.35014066
               .07988310             0.04467461
        ''')
ano_c = gto.basis.parse('''
        C    S
          50557.501                  0.0001128874          -0.0000250742           0.0000161788
           7524.7856                 0.0005295373          -0.0001175945           0.0000749712
           1694.3276                 0.0024500383          -0.0005456275           0.0003573467
            472.82279                0.0100539847          -0.0022450771           0.0014349316
            151.71075                0.0354539806          -0.0080434718           0.0055086779
             53.918746               0.1044071086          -0.0244258871           0.0169149690
             20.659311               0.2412894918          -0.0613679118           0.0514166524
              8.3839760              0.3834225483          -0.1177767835           0.1137343741
              3.5770150              0.3078514393          -0.1550487783           0.2337183944
              1.5471180              0.0687244299          -0.0193331686          -0.0718378257
               .61301300             0.0002224445           0.3996930678          -1.0490908711
               .24606800             0.0019767489           0.5589420949          -0.0666273399
               .09908700             0.0020578594           0.1711195023           1.0119993798
               .03468000             0.0004182020           0.0074562446           0.1656046386
        C    P
             83.333155               0.0013446560          -0.0017715885
             19.557611               0.0102355550          -0.0145621810
              6.0803650              0.0452006710          -0.0574573357
              2.1793170              0.1410756198          -0.2126582848
               .86515000             0.3047388085          -0.5271712924
               .36194400             0.3995281011          -0.0929697730
               .15474000             0.2719163432           0.6630031669
               .06542900             0.0585766933           0.3360877793
               .02290000            -0.0001263813           0.0054695244
        C    D
              1.9000000              0.1424518048
               .66500000             0.5591973019
               .23275000             0.4430004380
               .08146300             0.0410665370
        ''')
ano_h = gto.basis.parse('''
        H    S
            188.61445                 .00096385             -.0013119
             28.276596                .00749196             -.0103451
              6.4248300               .03759541             -.0504953
              1.8150410               .14339498             -.2073855
               .59106300              .34863630             -.4350885
               .21214900              .43829736             -.0247297
               .07989100              .16510661              .32252599
               .02796200              .02102287              .70727538
        H    P
              2.3050000               .11279019
               .80675000              .41850753
               .28236200              .47000773
               .09882700              .18262603
        ''')

mpg = 'c1'




#==================================================================
# Dump integrals from chkfile
#==================================================================
from pyscf import lib
mol = gto.M(atom=atom, symmetry=mpg, basis= {'Fe': ano_fe, 'S': ano_s, 'C': ano_c, 'H': ano_h},
                         spin=twos, charge=charge, verbose=5)    
mo = lib.chkfile.load(mychkfile_loc, 'luno/mo_coeff')


from pyscf import mcscf         # MCSCF: Multi-configuration self-consistent field
# mc = mcscf.CASCI(scf.sfx2c(scf.RKS(mol)), norb, nelec)
mc = mcscf.CASCI(scf.ROHF(mol), norb, nelec)

                                # CASCI: Complete Active Space config. integral
                                #       wave ftn is L-comb of Slater-det.s
                                #       expansion coeff solved in variational procedure
                                #   Note) fixed oribitals!
                     
mc.mo_coeff = mo                # [Fe2S2(SCH3)2]2-

assert len(act_idx) == norb     # norb: # of orbitals

mo = mc.sort_mo(mo_coeff = mo,caslst=act_idx, base=1)        # pushes empty spaces in list (...)
print(mo)


mc.mo_coeff = mo


h1e, ecore = mc.get_h1eff()     # get_h1eff(): CAS space one-electron hamiltonian
                                # h1e: effective one-electron hamiltonian 
                                #       defined in CAS space
                                # ecore: electronic energy from core
g2e = mc.get_h2eff()            # get_h2eff(): active space two-particle Hamiltonian
g2e = ao2mo.restore(1, g2e, norb)
                                # g2e: converted the 2e intgrl (in Chemist's notation)
                                #       between different
                                #       level of permutation symmetry
dumpERIs(myFCIDUMPfile, header, int1e=h1e, int2e=g2e, ecore=ecore)       
                                # ERI: electron repulsion integral
                                # Final Hamiltonian
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='master', release='5.4.0-174-generic', version='#193-Ubuntu SMP Thu Mar 7 14:29:28 UTC 2024', machine='x86_64', processor='x86_64')  Threads 12
Python 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21) 
[GCC 9.4.0]
numpy 1.21.5  scipy 1.7.3
Date: Wed Aug 14 21:13:54 2024
PySCF version 2.4.0
PySCF path  /home/amychoi7/programs/pyscf
GIT HEAD (branch master) 8b7c13a1f91c04bbfc5397800feb77506df5e7df

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 24
[INPUT] num. electrons = 187
[INPUT] charge = -3
[INPUT] spin (= nelec alpha-beta = 2S) = 9
[INPUT] symmetry C1 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Fe     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 S      1.803282000000   1.552038000000  -0.015832000000 AA    3.407709105358   2.932926754918  -0.029918144004 Bohr   0.0
[INPUT]  3 S      0.179063000000  -1.428559000000   1.984882000000 AA    0.338380029043  -2.699585262783   3.750883369579 Bohr   0.0
[INPUT]  4 S      0.156011000000  -1.489475000000  -1.887889000000 AA    0.294818062420  -2.814699819387  -3.567593163579 Bohr   0.0
[INPUT]  5 S     -1.799241000000   1.534638000000  -0.026753000000 AA   -3.400072722089   2.900045520350  -0.050555843010 Bohr   0.0
[INPUT]  6 Fe     0.000000000000   2.913846000000   0.000000000000 AA    0.000000000000   5.506370909159   0.000000000000 Bohr   0.0
[INPUT]  7 S      0.160778000000   4.414680000000  -1.934049000000 AA    0.303826386855   8.342536127595  -3.654822921489 Bohr   0.0
[INPUT]  8 S     -0.108071000000   4.429884000000   1.936840000000 AA   -0.204224592008   8.371267523593   3.660097147103 Bohr   0.0
[INPUT]  9 C     -0.912210000000  -2.963849000000  -1.242889000000 AA   -1.723827068089  -5.600862884566  -2.348719813235 Bohr   0.0
[INPUT] 10 H     -1.989184000000  -2.859451000000  -1.562462000000 AA   -3.759012971367  -5.403579256614  -2.952625260040 Bohr   0.0
[INPUT] 11 H     -0.525883000000  -3.945369000000  -1.615675000000 AA   -0.993774843565  -7.455666870349  -3.053183256307 Bohr   0.0
[INPUT] 12 H     -0.867825000000  -2.932516000000  -0.120549000000 AA   -1.639951574051  -5.541652095905  -0.227804594590 Bohr   0.0
[INPUT] 13 C      1.844709000000  -2.175921000000   1.378192000000 AA    3.485994789520  -4.111894758690   2.604405427067 Bohr   0.0
[INPUT] 14 H      2.638850000000  -1.403540000000   1.474465000000 AA    4.986703783809  -2.652306204872   2.786335030257 Bohr   0.0
[INPUT] 15 H      2.132068000000  -3.090314000000   1.972928000000 AA    4.029024598949  -5.839847098909   3.728293583486 Bohr   0.0
[INPUT] 16 H      1.736050000000  -2.422125000000   0.300567000000 AA    3.280659038551  -4.577152889462   0.567989312082 Bohr   0.0
[INPUT] 17 C      1.648897000000   5.101058000000   1.488302000000 AA    3.115963737617   9.639602565522   2.812483170642 Bohr   0.0
[INPUT] 18 H      1.607332000000   5.507634000000   0.450386000000 AA    3.037417271249  10.407919854343   0.851106190338 Bohr   0.0
[INPUT] 19 H      1.973504000000   5.885932000000   2.215354000000 AA    3.729382065734  11.122799467813   4.186412328960 Bohr   0.0
[INPUT] 20 H      2.354855000000   4.241919000000   1.489893000000 AA    4.450031013063   8.016065152589   2.815489724907 Bohr   0.0
[INPUT] 21 C     -1.554571000000   5.164995000000  -1.500913000000 AA   -2.937713431191   9.760425984748  -2.836314506799 Bohr   0.0
[INPUT] 22 H     -1.840202000000   5.975229000000  -2.224677000000 AA   -3.477477793877  11.291546341559  -4.204030245619 Bohr   0.0
[INPUT] 23 H     -2.318714000000   4.341993000000  -1.513295000000 AA   -4.381734421195   8.205177604779  -2.859713095674 Bohr   0.0
[INPUT] 24 H     -1.506866000000   5.565668000000  -0.459671000000 AA   -2.847564046419  10.517588220256  -0.868652297405 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Fe
[INPUT] 0    0    [21   /5   ]  4316265           0.00015003 -4.622e-05 1.71e-05 -3.53e-06 4.23e-06
                                646342.4          0.00043597 -0.00013445 4.975e-05 -1.026e-05 1.234e-05
                                147089.7          0.00120365 -0.00037184 0.00013758 -2.838e-05 3.4e-05
                                41661.52          0.00312635 -0.00096889 0.00035879 -7.397e-05 8.934e-05
                                13590.77          0.00814591 -0.00253948 0.00094021 -0.0001941 0.00023098
                                4905.75           0.02133892 -0.00673001 0.0024986 -0.00051496 0.00062709
                                1912.746          0.05470838 -0.0176816 0.00657103 -0.00135801 0.00160135
                                792.6043          0.12845394 -0.0437541 0.01640473 -0.00338297 0.00416181
                                344.8065          0.25203824 -0.09601111 0.03637157 -0.00754121 0.00877359
                                155.8999          0.35484986 -0.16998599 0.06664937 -0.01380066 0.01738346
                                72.23091          0.27043078 -0.18456376 0.07553682 -0.01588736 0.01718943
                                32.72506          0.06476086 0.058263 -0.02586806 0.00570363 -0.00196602
                                15.66762          -0.00110466 0.52163758 -0.3123023 0.06807261 -0.09285258
                                7.503483          0.00184555 0.49331062 -0.44997654 0.10526256 -0.113506
                                3.312223          -0.000856 0.0863267 0.14773374 -0.04562463 0.01812457
                                1.558471          0.00037119 -0.00285017 0.72995709 -0.21341607 0.41268036
                                0.683914          -0.00014687 0.00165569 0.38458847 -0.24353659 0.10339104
                                0.146757          6.097e-05 -0.00049176 0.0158289 0.34358715 -0.89083095
                                0.070583          -5.789e-05 0.00047608 -0.00949537 0.46401833 -0.80961283
                                0.031449          2.77e-05 -0.0002282 0.00308038 0.34688312 1.52308946
                                0.01258           -7.22e-06 6.297e-05 -0.00100526 0.01225841 0.09142619
[INPUT] 1    0    [15   /4   ]  7721.489          0.00035287 -0.00012803 -0.00013663 3.845e-05
                                1829.126          0.00196928 -0.00071517 -0.0007779 0.00021618
                                593.628           0.00961737 -0.00352108 -0.00375042 0.00105697
                                226.2054          0.03724273 -0.01379065 -0.01516741 0.00418424
                                95.26145          0.11332297 -0.04331452 -0.04705206 0.01307817
                                42.8592           0.25335172 -0.10061222 -0.1152963 0.0309551
                                20.04971          0.38104215 -0.16161377 -0.17017078 0.04896849
                                9.620885          0.3070325 -0.11214083 -0.1322083 0.03516849
                                4.541371          0.08654534 0.18501865 0.53797582 -0.08338612
                                2.1135            0.00359924 0.4789308 0.61199701 -0.17709305
                                0.947201          0.00144059 0.40514792 -0.64465308 -0.11907766
                                0.391243          -0.00029901 0.0987216 -0.61225551 0.12237413
                                0.156497          0.00020351 -0.00148592 0.10798966 0.5499813
                                0.062599          -9.626e-05 0.00222977 0.37358045 0.39970337
                                0.02504           2.881e-05 -0.00072259 0.1878287 0.08298275
[INPUT] 2    0    [10   /2   ]  217.3688          0.00096699 -0.00098327
                                64.99976          0.00793294 -0.00789694
                                24.77314          0.03548314 -0.0364479
                                10.43614          0.10769519 -0.10760712
                                4.679653          0.22555488 -0.26104796
                                2.125622          0.31942979 -0.29085509
                                0.945242          0.3235439 0.01254821
                                0.402685          0.2433827 0.40386046
                                0.156651          0.10680569 0.38672483
                                0.06266           0.02052711 0.243945
[INPUT] 3    0    [6    /1   ]  11.2749           0.03802196
                                4.469             0.25501829
                                1.7713            0.50897998
                                0.7021            0.35473516
                                0.2783            0.12763297
                                0.1103            0.01946831
[INPUT] S
[INPUT] 0    0    [17   /4   ]  346348.23         0.00029092 -8.101e-05 2.28e-05 -2.342e-05
                                49391.146         0.00094665 -0.00026388 7.421e-05 -7.637e-05
                                14610.99          0.00211923 -0.00059263 0.00016719 -0.00017089
                                5187.2095         0.00602161 -0.00168762 0.00047372 -0.00048999
                                1980.9676         0.01659726 -0.00470357 0.00133106 -0.00135293
                                784.63139         0.04683989 -0.01350607 0.00379801 -0.0039282
                                317.32779         0.12242581 -0.03711959 0.01058108 -0.01067637
                                130.01976         0.27022435 -0.09114723 0.0260197 -0.02661813
                                53.738208         0.40541657 -0.17780418 0.05279001 -0.05183027
                                22.345896         0.25571527 -0.17069592 0.05191878 -0.05362245
                                9.3332512         0.02671693 0.17423163 -0.05692828 0.07080611
                                3.9111868         0.00390332 0.63283682 -0.2909519 0.28624981
                                1.6432066         -0.00204189 0.35886635 -0.31632828 0.49626307
                                0.6917456         0.00149034 -0.00096444 0.29309938 -1.07109282
                                0.2916736         -0.00062107 0.00659942 0.66787427 -0.7920747
                                0.1231441         0.00044167 -0.00522266 0.28725199 1.19881853
                                0.0492576         -3.24e-06 0.00029385 0.01516887 0.3247575
[INPUT] 1    0    [12   /3   ]  1129.1269         0.00090586 -0.00022454 0.00021481
                                274.03515         0.00600033 -0.0014885 0.00137868
                                97.402584         0.02531166 -0.00634942 0.00612706
                                38.085518         0.09198941 -0.02344282 0.02170457
                                15.471033         0.24165028 -0.06370257 0.06243734
                                6.405659          0.41029096 -0.11197083 0.10108619
                                2.6812828         0.35219287 -0.10347278 0.11708231
                                1.130005          0.08281645 0.10903888 -0.16261828
                                0.4783995         9.28e-05 0.41838741 -0.66461283
                                0.2031805         -0.00223897 0.43694091 -0.00256719
                                0.0864923         -0.0013105 0.18619701 0.71028173
                                0.0345969         -0.00022092 0.02837119 0.32134414
[INPUT] 2    0    [5    /1   ]  3.0053679         0.035815
                                1.2172976         0.16734186
                                0.4930556         0.57605251
                                0.1997078         0.35014066
                                0.0798831         0.04467461
[INPUT] C
[INPUT] 0    0    [14   /3   ]  50557.501         0.0001128874 -2.50742e-05 1.61788e-05
                                7524.7856         0.0005295373 -0.0001175945 7.49712e-05
                                1694.3276         0.0024500383 -0.0005456275 0.0003573467
                                472.82279         0.0100539847 -0.0022450771 0.0014349316
                                151.71075         0.0354539806 -0.0080434718 0.0055086779
                                53.918746         0.1044071086 -0.0244258871 0.016914969
                                20.659311         0.2412894918 -0.0613679118 0.0514166524
                                8.383976          0.3834225483 -0.1177767835 0.1137343741
                                3.577015          0.3078514393 -0.1550487783 0.2337183944
                                1.547118          0.0687244299 -0.0193331686 -0.0718378257
                                0.613013          0.0002224445 0.3996930678 -1.0490908711
                                0.246068          0.0019767489 0.5589420949 -0.0666273399
                                0.099087          0.0020578594 0.1711195023 1.0119993798
                                0.03468           0.000418202 0.0074562446 0.1656046386
[INPUT] 1    0    [9    /2   ]  83.333155         0.001344656 -0.0017715885
                                19.557611         0.010235555 -0.014562181
                                6.080365          0.045200671 -0.0574573357
                                2.179317          0.1410756198 -0.2126582848
                                0.86515           0.3047388085 -0.5271712924
                                0.361944          0.3995281011 -0.092969773
                                0.15474           0.2719163432 0.6630031669
                                0.065429          0.0585766933 0.3360877793
                                0.0229            -0.0001263813 0.0054695244
[INPUT] 2    0    [4    /1   ]  1.9               0.1424518048
                                0.665             0.5591973019
                                0.23275           0.443000438
                                0.081463          0.041066537
[INPUT] H
[INPUT] 0    0    [8    /2   ]  188.61445         0.00096385 -0.0013119
                                28.276596         0.00749196 -0.0103451
                                6.42483           0.03759541 -0.0504953
                                1.815041          0.14339498 -0.2073855
                                0.591063          0.3486363 -0.4350885
                                0.212149          0.43829736 -0.0247297
                                0.079891          0.16510661 0.32252599
                                0.027962          0.02102287 0.70727538
[INPUT] 1    0    [4    /1   ]  2.305             0.11279019
                                0.80675           0.41850753
                                0.282362          0.47000773
                                0.098827          0.18262603

nuclear repulsion = 2267.48697325318
point group symmetry = C1
symmetry origin: [0. 0. 0.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep A = 292
number of shells = 62
number of NR pGTOs = 1268
number of NR cGTOs = 292
basis = {'Fe': [[0, [4316265.0, 0.00015003, -4.622e-05, 1.71e-05, -3.53e-06, 4.23e-06], [646342.4, 0.00043597, -0.00013445, 4.975e-05, -1.026e-05, 1.234e-05], [147089.7, 0.00120365, -0.00037184, 0.00013758, -2.838e-05, 3.4e-05], [41661.52, 0.00312635, -0.00096889, 0.00035879, -7.397e-05, 8.934e-05], [13590.77, 0.00814591, -0.00253948, 0.00094021, -0.0001941, 0.00023098], [4905.75, 0.02133892, -0.00673001, 0.0024986, -0.00051496, 0.00062709], [1912.746, 0.05470838, -0.0176816, 0.00657103, -0.00135801, 0.00160135], [792.6043, 0.12845394, -0.0437541, 0.01640473, -0.00338297, 0.00416181], [344.8065, 0.25203824, -0.09601111, 0.03637157, -0.00754121, 0.00877359], [155.8999, 0.35484986, -0.16998599, 0.06664937, -0.01380066, 0.01738346], [72.23091, 0.27043078, -0.18456376, 0.07553682, -0.01588736, 0.01718943], [32.72506, 0.06476086, 0.058263, -0.02586806, 0.00570363, -0.00196602], [15.66762, -0.00110466, 0.52163758, -0.3123023, 0.06807261, -0.09285258], [7.503483, 0.00184555, 0.49331062, -0.44997654, 0.10526256, -0.113506], [3.312223, -0.000856, 0.0863267, 0.14773374, -0.04562463, 0.01812457], [1.558471, 0.00037119, -0.00285017, 0.72995709, -0.21341607, 0.41268036], [0.683914, -0.00014687, 0.00165569, 0.38458847, -0.24353659, 0.10339104], [0.146757, 6.097e-05, -0.00049176, 0.0158289, 0.34358715, -0.89083095], [0.070583, -5.789e-05, 0.00047608, -0.00949537, 0.46401833, -0.80961283], [0.031449, 2.77e-05, -0.0002282, 0.00308038, 0.34688312, 1.52308946], [0.01258, -7.22e-06, 6.297e-05, -0.00100526, 0.01225841, 0.09142619]], [1, [7721.489, 0.00035287, -0.00012803, -0.00013663, 3.845e-05], [1829.126, 0.00196928, -0.00071517, -0.0007779, 0.00021618], [593.628, 0.00961737, -0.00352108, -0.00375042, 0.00105697], [226.2054, 0.03724273, -0.01379065, -0.01516741, 0.00418424], [95.26145, 0.11332297, -0.04331452, -0.04705206, 0.01307817], [42.8592, 0.25335172, -0.10061222, -0.1152963, 0.0309551], [20.04971, 0.38104215, -0.16161377, -0.17017078, 0.04896849], [9.620885, 0.3070325, -0.11214083, -0.1322083, 0.03516849], [4.541371, 0.08654534, 0.18501865, 0.53797582, -0.08338612], [2.1135, 0.00359924, 0.4789308, 0.61199701, -0.17709305], [0.947201, 0.00144059, 0.40514792, -0.64465308, -0.11907766], [0.391243, -0.00029901, 0.0987216, -0.61225551, 0.12237413], [0.156497, 0.00020351, -0.00148592, 0.10798966, 0.5499813], [0.062599, -9.626e-05, 0.00222977, 0.37358045, 0.39970337], [0.02504, 2.881e-05, -0.00072259, 0.1878287, 0.08298275]], [2, [217.3688, 0.00096699, -0.00098327], [64.99976, 0.00793294, -0.00789694], [24.77314, 0.03548314, -0.0364479], [10.43614, 0.10769519, -0.10760712], [4.679653, 0.22555488, -0.26104796], [2.125622, 0.31942979, -0.29085509], [0.945242, 0.3235439, 0.01254821], [0.402685, 0.2433827, 0.40386046], [0.156651, 0.10680569, 0.38672483], [0.06266, 0.02052711, 0.243945]], [3, [11.2749, 0.03802196], [4.469, 0.25501829], [1.7713, 0.50897998], [0.7021, 0.35473516], [0.2783, 0.12763297], [0.1103, 0.01946831]]], 'S': [[0, [346348.23, 0.00029092, -8.101e-05, 2.28e-05, -2.342e-05], [49391.146, 0.00094665, -0.00026388, 7.421e-05, -7.637e-05], [14610.99, 0.00211923, -0.00059263, 0.00016719, -0.00017089], [5187.2095, 0.00602161, -0.00168762, 0.00047372, -0.00048999], [1980.9676, 0.01659726, -0.00470357, 0.00133106, -0.00135293], [784.63139, 0.04683989, -0.01350607, 0.00379801, -0.0039282], [317.32779, 0.12242581, -0.03711959, 0.01058108, -0.01067637], [130.01976, 0.27022435, -0.09114723, 0.0260197, -0.02661813], [53.738208, 0.40541657, -0.17780418, 0.05279001, -0.05183027], [22.345896, 0.25571527, -0.17069592, 0.05191878, -0.05362245], [9.3332512, 0.02671693, 0.17423163, -0.05692828, 0.07080611], [3.9111868, 0.00390332, 0.63283682, -0.2909519, 0.28624981], [1.6432066, -0.00204189, 0.35886635, -0.31632828, 0.49626307], [0.6917456, 0.00149034, -0.00096444, 0.29309938, -1.07109282], [0.2916736, -0.00062107, 0.00659942, 0.66787427, -0.7920747], [0.1231441, 0.00044167, -0.00522266, 0.28725199, 1.19881853], [0.0492576, -3.24e-06, 0.00029385, 0.01516887, 0.3247575]], [1, [1129.1269, 0.00090586, -0.00022454, 0.00021481], [274.03515, 0.00600033, -0.0014885, 0.00137868], [97.402584, 0.02531166, -0.00634942, 0.00612706], [38.085518, 0.09198941, -0.02344282, 0.02170457], [15.471033, 0.24165028, -0.06370257, 0.06243734], [6.405659, 0.41029096, -0.11197083, 0.10108619], [2.6812828, 0.35219287, -0.10347278, 0.11708231], [1.130005, 0.08281645, 0.10903888, -0.16261828], [0.4783995, 9.28e-05, 0.41838741, -0.66461283], [0.2031805, -0.00223897, 0.43694091, -0.00256719], [0.0864923, -0.0013105, 0.18619701, 0.71028173], [0.0345969, -0.00022092, 0.02837119, 0.32134414]], [2, [3.0053679, 0.035815], [1.2172976, 0.16734186], [0.4930556, 0.57605251], [0.1997078, 0.35014066], [0.0798831, 0.04467461]]], 'C': [[0, [50557.501, 0.0001128874, -2.50742e-05, 1.61788e-05], [7524.7856, 0.0005295373, -0.0001175945, 7.49712e-05], [1694.3276, 0.0024500383, -0.0005456275, 0.0003573467], [472.82279, 0.0100539847, -0.0022450771, 0.0014349316], [151.71075, 0.0354539806, -0.0080434718, 0.0055086779], [53.918746, 0.1044071086, -0.0244258871, 0.016914969], [20.659311, 0.2412894918, -0.0613679118, 0.0514166524], [8.383976, 0.3834225483, -0.1177767835, 0.1137343741], [3.577015, 0.3078514393, -0.1550487783, 0.2337183944], [1.547118, 0.0687244299, -0.0193331686, -0.0718378257], [0.613013, 0.0002224445, 0.3996930678, -1.0490908711], [0.246068, 0.0019767489, 0.5589420949, -0.0666273399], [0.099087, 0.0020578594, 0.1711195023, 1.0119993798], [0.03468, 0.000418202, 0.0074562446, 0.1656046386]], [1, [83.333155, 0.001344656, -0.0017715885], [19.557611, 0.010235555, -0.014562181], [6.080365, 0.045200671, -0.0574573357], [2.179317, 0.1410756198, -0.2126582848], [0.86515, 0.3047388085, -0.5271712924], [0.361944, 0.3995281011, -0.092969773], [0.15474, 0.2719163432, 0.6630031669], [0.065429, 0.0585766933, 0.3360877793], [0.0229, -0.0001263813, 0.0054695244]], [2, [1.9, 0.1424518048], [0.665, 0.5591973019], [0.23275, 0.443000438], [0.081463, 0.041066537]]], 'H': [[0, [188.61445, 0.00096385, -0.0013119], [28.276596, 0.00749196, -0.0103451], [6.42483, 0.03759541, -0.0504953], [1.815041, 0.14339498, -0.2073855], [0.591063, 0.3486363, -0.4350885], [0.212149, 0.43829736, -0.0247297], [0.079891, 0.16510661, 0.32252599], [0.027962, 0.02102287, 0.70727538]], [1, [2.305, 0.11279019], [0.80675, 0.41850753], [0.282362, 0.47000773], [0.098827, 0.18262603]]]}
ecp = {}
CPU time:         1.09
[[ 9.99998527e-01  1.94374381e-06 -6.12708761e-06 ... -6.04474742e-06
   5.28410818e-04  3.23721091e-05]
 [-6.20975220e-06  1.38203386e-05 -4.44020331e-05 ... -4.40183801e-05
   3.85125665e-03  1.91818053e-04]
 [-4.94972963e-05  6.79678206e-05 -2.12165578e-04 ... -2.24173003e-04
   2.03896746e-02 -3.29313287e-04]
 ...
 [-5.43506591e-07  7.38254291e-07 -2.06593350e-06 ... -1.80973459e-03
   1.87516663e-04  1.66456382e-03]
 [ 3.44798264e-06 -9.74368865e-06  4.08299527e-06 ...  1.97284772e-03
  -6.84040804e-05 -1.12116839e-03]
 [ 2.03382479e-06 -2.26690380e-06  3.77453735e-06 ... -6.31985794e-04
  -4.27205929e-05  6.88269687e-04]]
    CPU time for init_direct_scf      5.92 sec, wall time      0.50 sec
    CPU time for vj and vk   1693.72 sec, wall time    144.05 sec
MO integrals int2e_sph are saved in <HDF5 file "tmpaso9s4lc" (mode r+)>/eri_mo
num. MO ints = 64009, required disk 0.512072 MB
step1: tmpfile /tmp/tmprnwtjhy_  86.582672 MB
step1: (ij,kl) = (253,42778), mem cache 4000 MB, iobuf 800 MB
    CPU time for Initializing ao2mo.outcore.half_e1      4.84 sec, wall time      0.41 sec
    CPU time for AO->MO transformation for int2e_sph 1 pass   3479.16 sec, wall time    332.97 sec
step2: kl-pair (ao 42778, mo 253), mem 54.75584 MB, ioblock 0.32384 MB
    CPU time for AO->MO transformation for int2e_sph 2 pass      4.57 sec, wall time      0.39 sec
    CPU time for AO->MO transformation for int2e_sph    3483.73 sec, wall time    333.36 sec

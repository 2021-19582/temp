[14, 16, 17, 89, 90, 91, 93, 96, 92, 94, 95, 97, 98]
#INFO: **** input file is /home/amychoi7/git/temp/03_dumpInt.py ****

"""
Dump integrals from chkfile using pyscf.

Author: Seunghoon Lee, Jan 17, 2022
Edited: Inyoung  Choi, Jan 16, 2024
Edited2: Inyoung Choi, May 02, 2024

"""

import numpy as np
from tools_io import dumpERIs
from pyscf import gto, scf, dft, ao2mo
# FCI: Full Config Integral
# ASP: adiabatic state preparation
import sys
#==================================================================
# TODO 
#==================================================================
model = 'feIIIfeII_13o17eR_lunocloc' # FIXME
norb = 13 # FIXME
nelec = [9,8] # FIXME               # [ # of a, # of b ]

# FIXME
header =""" &FCI NORB=13,NELEC=17,MS2=0,
  ORBSYM=1,1,1,1,1,1,1,1,1,1,1,1,1,
  ISYM=1,
 &END
"""


mychkfile_loc = '/home/amychoi7/git/pyxray2/data/fe2s2/' + 'feIIIfeII_lunocloc.h5'
myFCIDUMPfile = 'FCIDUMP'


act_idx = [] # MO indexes of active space (in jmol order)
act1 = [14,16,17] # feR 2p
act2 = [89,90,91,93,96] # feL 3d
act4 = [92,94,95,97,98] # feR 3d

act_idx = act1+act2+act4
print(act_idx)

#sys.exit()

atom = """
        Fe	5.48	1.15	-8.03
        S	4.05	-0.61	-8.75
        S	5.47	1.25	-5.58
        S	4.63	3.28	-8.77
        S	7.49	0.42	-9.04
        Fe	6.04	-1.22	-9.63
        S	5.75	-1.5	-12.05
        S	6.86	-3.41	-8.86
        C	5.51	4.45	-7.51
        H	6.49	4.83	-7.92
        H	4.87	5.33	-7.25
        H	5.72	3.84	-6.59
        C	3.6	1.7	-5.54
        H	3.01	0.8	-5.82
        H	3.28	2.06	-4.52
        H	3.42	2.48	-6.31
        C	5.21	-4.22	-9.46
        H	5.1	-4.01	-10.55
        H	5.21	-5.32	-9.26
        H	4.37	-3.72	-8.93
        C	7.63	-1.85	-12.24
        H	7.9	-2.06	-13.31
        H	8.2	-0.96	-11.86
        H	7.89	-2.72	-11.59
        """
charge = -3
twos = 9

ano_fe = gto.basis.parse('''
        Fe    S
        4316265.                     0.00015003            -0.00004622             0.00001710            -0.00000353             0.00000423
         646342.4                    0.00043597            -0.00013445             0.00004975            -0.00001026             0.00001234
         147089.7                    0.00120365            -0.00037184             0.00013758            -0.00002838             0.00003400
          41661.52                   0.00312635            -0.00096889             0.00035879            -0.00007397             0.00008934
          13590.77                   0.00814591            -0.00253948             0.00094021            -0.00019410             0.00023098
           4905.750                  0.02133892            -0.00673001             0.00249860            -0.00051496             0.00062709
           1912.746                  0.05470838            -0.01768160             0.00657103            -0.00135801             0.00160135
            792.6043                 0.12845394            -0.04375410             0.01640473            -0.00338297             0.00416181
            344.8065                 0.25203824            -0.09601111             0.03637157            -0.00754121             0.00877359
            155.8999                 0.35484986            -0.16998599             0.06664937            -0.01380066             0.01738346
             72.23091                0.27043078            -0.18456376             0.07553682            -0.01588736             0.01718943
             32.72506                0.06476086             0.05826300            -0.02586806             0.00570363            -0.00196602
             15.66762               -0.00110466             0.52163758            -0.31230230             0.06807261            -0.09285258
              7.503483               0.00184555             0.49331062            -0.44997654             0.10526256            -0.11350600
              3.312223              -0.00085600             0.08632670             0.14773374            -0.04562463             0.01812457
              1.558471               0.00037119            -0.00285017             0.72995709            -0.21341607             0.41268036
              0.683914              -0.00014687             0.00165569             0.38458847            -0.24353659             0.10339104
              0.146757               0.00006097            -0.00049176             0.01582890             0.34358715            -0.89083095
              0.070583              -0.00005789             0.00047608            -0.00949537             0.46401833            -0.80961283
              0.031449               0.00002770            -0.00022820             0.00308038             0.34688312             1.52308946
              0.012580              -0.00000722             0.00006297            -0.00100526             0.01225841             0.09142619
        Fe    P
           7721.489                  0.00035287            -0.00012803            -0.00013663             0.00003845
           1829.126                  0.00196928            -0.00071517            -0.00077790             0.00021618
            593.6280                 0.00961737            -0.00352108            -0.00375042             0.00105697
            226.2054                 0.03724273            -0.01379065            -0.01516741             0.00418424
             95.26145                0.11332297            -0.04331452            -0.04705206             0.01307817
             42.85920                0.25335172            -0.10061222            -0.11529630             0.03095510
             20.04971                0.38104215            -0.16161377            -0.17017078             0.04896849
              9.620885               0.30703250            -0.11214083            -0.13220830             0.03516849
              4.541371               0.08654534             0.18501865             0.53797582            -0.08338612
              2.113500               0.00359924             0.47893080             0.61199701            -0.17709305
              0.947201               0.00144059             0.40514792            -0.64465308            -0.11907766
              0.391243              -0.00029901             0.09872160            -0.61225551             0.12237413
              0.156497               0.00020351            -0.00148592             0.10798966             0.54998130
              0.062599              -0.00009626             0.00222977             0.37358045             0.39970337
              0.025040               0.00002881            -0.00072259             0.18782870             0.08298275
        Fe    D
            217.3688                 0.00096699            -0.00098327
             64.99976                0.00793294            -0.00789694
             24.77314                0.03548314            -0.03644790
             10.43614                0.10769519            -0.10760712
              4.679653               0.22555488            -0.26104796
              2.125622               0.31942979            -0.29085509
              0.945242               0.32354390             0.01254821
              0.402685               0.24338270             0.40386046
              0.156651               0.10680569             0.38672483
              0.062660               0.02052711             0.24394500
        Fe    F
             11.2749                 0.03802196
              4.4690                 0.25501829
              1.7713                 0.50897998
               .7021                 0.35473516
               .2783                 0.12763297
               .1103                 0.01946831
        ''')
ano_s = gto.basis.parse('''
        S    S
         346348.23                   0.00029092            -0.00008101             0.00002280            -0.00002342
          49391.146                  0.00094665            -0.00026388             0.00007421            -0.00007637
          14610.990                  0.00211923            -0.00059263             0.00016719            -0.00017089
           5187.2095                 0.00602161            -0.00168762             0.00047372            -0.00048999
           1980.9676                 0.01659726            -0.00470357             0.00133106            -0.00135293
            784.63139                0.04683989            -0.01350607             0.00379801            -0.00392820
            317.32779                0.12242581            -0.03711959             0.01058108            -0.01067637
            130.01976                0.27022435            -0.09114723             0.02601970            -0.02661813
             53.738208               0.40541657            -0.17780418             0.05279001            -0.05183027
             22.345896               0.25571527            -0.17069592             0.05191878            -0.05362245
              9.3332512              0.02671693             0.17423163            -0.05692828             0.07080611
              3.9111868              0.00390332             0.63283682            -0.29095190             0.28624981
              1.6432066             -0.00204189             0.35886635            -0.31632828             0.49626307
               .69174560             0.00149034            -0.00096444             0.29309938            -1.07109282
               .29167360            -0.00062107             0.00659942             0.66787427            -0.79207470
               .12314410             0.00044167            -0.00522266             0.28725199             1.19881853
               .04925760            -0.00000324             0.00029385             0.01516887             0.32475750
        S    P
           1129.1269                 0.00090586            -0.00022454             0.00021481
            274.03515                0.00600033            -0.00148850             0.00137868
             97.402584               0.02531166            -0.00634942             0.00612706
             38.085518               0.09198941            -0.02344282             0.02170457
             15.471033               0.24165028            -0.06370257             0.06243734
              6.4056590              0.41029096            -0.11197083             0.10108619
              2.6812828              0.35219287            -0.10347278             0.11708231
              1.1300050              0.08281645             0.10903888            -0.16261828
               .47839950             0.00009280             0.41838741            -0.66461283
               .20318050            -0.00223897             0.43694091            -0.00256719
               .08649230            -0.00131050             0.18619701             0.71028173
               .03459690            -0.00022092             0.02837119             0.32134414
        S    D
              3.0053679              0.03581500
              1.2172976              0.16734186
               .49305560             0.57605251
               .19970780             0.35014066
               .07988310             0.04467461
        ''')
ano_c = gto.basis.parse('''
        C    S
          50557.501                  0.0001128874          -0.0000250742           0.0000161788
           7524.7856                 0.0005295373          -0.0001175945           0.0000749712
           1694.3276                 0.0024500383          -0.0005456275           0.0003573467
            472.82279                0.0100539847          -0.0022450771           0.0014349316
            151.71075                0.0354539806          -0.0080434718           0.0055086779
             53.918746               0.1044071086          -0.0244258871           0.0169149690
             20.659311               0.2412894918          -0.0613679118           0.0514166524
              8.3839760              0.3834225483          -0.1177767835           0.1137343741
              3.5770150              0.3078514393          -0.1550487783           0.2337183944
              1.5471180              0.0687244299          -0.0193331686          -0.0718378257
               .61301300             0.0002224445           0.3996930678          -1.0490908711
               .24606800             0.0019767489           0.5589420949          -0.0666273399
               .09908700             0.0020578594           0.1711195023           1.0119993798
               .03468000             0.0004182020           0.0074562446           0.1656046386
        C    P
             83.333155               0.0013446560          -0.0017715885
             19.557611               0.0102355550          -0.0145621810
              6.0803650              0.0452006710          -0.0574573357
              2.1793170              0.1410756198          -0.2126582848
               .86515000             0.3047388085          -0.5271712924
               .36194400             0.3995281011          -0.0929697730
               .15474000             0.2719163432           0.6630031669
               .06542900             0.0585766933           0.3360877793
               .02290000            -0.0001263813           0.0054695244
        C    D
              1.9000000              0.1424518048
               .66500000             0.5591973019
               .23275000             0.4430004380
               .08146300             0.0410665370
        ''')
ano_h = gto.basis.parse('''
        H    S
            188.61445                 .00096385             -.0013119
             28.276596                .00749196             -.0103451
              6.4248300               .03759541             -.0504953
              1.8150410               .14339498             -.2073855
               .59106300              .34863630             -.4350885
               .21214900              .43829736             -.0247297
               .07989100              .16510661              .32252599
               .02796200              .02102287              .70727538
        H    P
              2.3050000               .11279019
               .80675000              .41850753
               .28236200              .47000773
               .09882700              .18262603
        ''')

mpg = 'c1'




#==================================================================
# Dump integrals from chkfile
#==================================================================
from pyscf import lib
mol = gto.M(atom=atom, symmetry=mpg, basis= {'Fe': ano_fe, 'S': ano_s, 'C': ano_c, 'H': ano_h},
                         spin=twos, charge=charge, verbose=5)    
mo = lib.chkfile.load(mychkfile_loc, 'luno/mo_coeff')


from pyscf import mcscf         # MCSCF: Multi-configuration self-consistent field
mc = mcscf.CASCI(scf.sfx2c(scf.RKS(mol)), norb, nelec)

                                # CASCI: Complete Active Space config. integral
                                #       wave ftn is L-comb of Slater-det.s
                                #       expansion coeff solved in variational procedure
                                #   Note) fixed oribitals!
                     
mc.mo_coeff = mo                # [Fe2S2(SCH3)2]2-

assert len(act_idx) == norb     # norb: # of orbitals

mo = mc.sort_mo(mo_coeff = mo,caslst=act_idx, base=1)        # pushes empty spaces in list (...)
print(mo)


mc.mo_coeff = mo


h1e, ecore = mc.get_h1eff()     # get_h1eff(): CAS space one-electron hamiltonian
                                # h1e: effective one-electron hamiltonian 
                                #       defined in CAS space
                                # ecore: electronic energy from core
g2e = mc.get_h2eff()            # get_h2eff(): active space two-particle Hamiltonian
g2e = ao2mo.restore(1, g2e, norb)
                                # g2e: converted the 2e intgrl (in Chemist's notation)
                                #       between different
                                #       level of permutation symmetry
dumpERIs(myFCIDUMPfile, header, int1e=h1e, int2e=g2e, ecore=ecore)       
                                # ERI: electron repulsion integral
                                # Final Hamiltonian
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='master', release='5.4.0-174-generic', version='#193-Ubuntu SMP Thu Mar 7 14:29:28 UTC 2024', machine='x86_64', processor='x86_64')  Threads 12
Python 3.7.12 | packaged by conda-forge | (default, Oct 26 2021, 06:08:21) 
[GCC 9.4.0]
numpy 1.21.5  scipy 1.7.3
Date: Thu Aug  1 16:39:29 2024
PySCF version 2.4.0
PySCF path  /home/amychoi7/programs/pyscf
GIT HEAD (branch master) 8b7c13a1f91c04bbfc5397800feb77506df5e7df

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 24
[INPUT] num. electrons = 187
[INPUT] charge = -3
[INPUT] spin (= nelec alpha-beta = 2S) = 9
[INPUT] symmetry C1 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Fe     5.480000000000   1.150000000000  -8.030000000000 AA   10.355699162617   2.173185043250 -15.174500780257 Bohr   0.0
[INPUT]  2 S      4.050000000000  -0.610000000000  -8.750000000000 AA    7.653390804488  -1.152732935985 -16.535103589944 Bohr   0.0
[INPUT]  3 S      5.470000000000   1.250000000000  -5.580000000000 AA   10.336801901371   2.362157655706 -10.544671775073 Bohr   0.0
[INPUT]  4 S      4.630000000000   3.280000000000  -8.770000000000 AA    8.749431956736   6.198301688573 -16.572898112436 Bohr   0.0
[INPUT]  5 S      7.490000000000   0.420000000000  -9.040000000000 AA   14.154048672992   0.793684972317 -17.083124166068 Bohr   0.0
[INPUT]  6 Fe     6.040000000000  -1.220000000000  -9.630000000000 AA   11.413945792373  -2.305465871969 -18.198062579562 Bohr   0.0
[INPUT]  7 S      5.750000000000  -1.500000000000 -12.050000000000 AA   10.865925216249  -2.834589186848 -22.771199801009 Bohr   0.0
[INPUT]  8 S      6.860000000000  -3.410000000000  -8.860000000000 AA   12.963521214516  -6.443966084767 -16.742973463646 Bohr   0.0
[INPUT]  9 C      5.510000000000   4.450000000000  -7.510000000000 AA   10.412390946353   8.409281254315 -14.191843195484 Bohr   0.0
[INPUT] 10 H      6.490000000000   4.830000000000  -7.920000000000 AA   12.264322548427   9.127377181649 -14.966630906555 Bohr   0.0
[INPUT] 11 H      4.870000000000   5.330000000000  -7.250000000000 AA    9.202966226632  10.072240243932 -13.700514403097 Bohr   0.0
[INPUT] 12 H      5.720000000000   3.840000000000  -6.590000000000 AA   10.809233432512   7.256548318330 -12.453295160884 Bohr   0.0
[INPUT] 13 C      3.600000000000   1.700000000000  -5.540000000000 AA    6.803014048434   3.212534411761 -10.469082730090 Bohr   0.0
[INPUT] 14 H      3.010000000000   0.800000000000  -5.820000000000 AA    5.688075634941   1.511780899652 -10.998206044969 Bohr   0.0
[INPUT] 15 H      3.280000000000   2.060000000000  -4.520000000000 AA    6.198301688573   3.892835816604  -8.541562083034 Bohr   0.0
[INPUT] 16 H      3.420000000000   2.480000000000  -6.310000000000 AA    6.462863346013   4.686520788921 -11.924171846006 Bohr   0.0
[INPUT] 17 C      5.210000000000  -4.220000000000  -9.460000000000 AA    9.845473108984  -7.974644245665 -17.876809138385 Bohr   0.0
[INPUT] 18 H      5.100000000000  -4.010000000000 -10.550000000000 AA    9.637603235282  -7.577801759506 -19.936610614161 Bohr   0.0
[INPUT] 19 H      5.210000000000  -5.320000000000  -9.260000000000 AA    9.845473108984 -10.053342982686 -17.498863913472 Bohr   0.0
[INPUT] 20 H      4.370000000000  -3.720000000000  -8.930000000000 AA    8.258103164349  -7.029781183382 -16.875254292366 Bohr   0.0
[INPUT] 21 C      7.630000000000  -1.850000000000 -12.240000000000 AA   14.418610330431  -3.495993330445 -23.130247764676 Bohr   0.0
[INPUT] 22 H      7.900000000000  -2.060000000000 -13.310000000000 AA   14.928836384064  -3.892835816604 -25.152254717961 Bohr   0.0
[INPUT] 23 H      8.200000000000  -0.960000000000 -11.860000000000 AA   15.495754221434  -1.814137079582 -22.412151837342 Bohr   0.0
[INPUT] 24 H      7.890000000000  -2.720000000000 -11.590000000000 AA   14.909939122818  -5.140055058817 -21.901925783709 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Fe
[INPUT] 0    0    [21   /5   ]  4316265           0.00015003 -4.622e-05 1.71e-05 -3.53e-06 4.23e-06
                                646342.4          0.00043597 -0.00013445 4.975e-05 -1.026e-05 1.234e-05
                                147089.7          0.00120365 -0.00037184 0.00013758 -2.838e-05 3.4e-05
                                41661.52          0.00312635 -0.00096889 0.00035879 -7.397e-05 8.934e-05
                                13590.77          0.00814591 -0.00253948 0.00094021 -0.0001941 0.00023098
                                4905.75           0.02133892 -0.00673001 0.0024986 -0.00051496 0.00062709
                                1912.746          0.05470838 -0.0176816 0.00657103 -0.00135801 0.00160135
                                792.6043          0.12845394 -0.0437541 0.01640473 -0.00338297 0.00416181
                                344.8065          0.25203824 -0.09601111 0.03637157 -0.00754121 0.00877359
                                155.8999          0.35484986 -0.16998599 0.06664937 -0.01380066 0.01738346
                                72.23091          0.27043078 -0.18456376 0.07553682 -0.01588736 0.01718943
                                32.72506          0.06476086 0.058263 -0.02586806 0.00570363 -0.00196602
                                15.66762          -0.00110466 0.52163758 -0.3123023 0.06807261 -0.09285258
                                7.503483          0.00184555 0.49331062 -0.44997654 0.10526256 -0.113506
                                3.312223          -0.000856 0.0863267 0.14773374 -0.04562463 0.01812457
                                1.558471          0.00037119 -0.00285017 0.72995709 -0.21341607 0.41268036
                                0.683914          -0.00014687 0.00165569 0.38458847 -0.24353659 0.10339104
                                0.146757          6.097e-05 -0.00049176 0.0158289 0.34358715 -0.89083095
                                0.070583          -5.789e-05 0.00047608 -0.00949537 0.46401833 -0.80961283
                                0.031449          2.77e-05 -0.0002282 0.00308038 0.34688312 1.52308946
                                0.01258           -7.22e-06 6.297e-05 -0.00100526 0.01225841 0.09142619
[INPUT] 1    0    [15   /4   ]  7721.489          0.00035287 -0.00012803 -0.00013663 3.845e-05
                                1829.126          0.00196928 -0.00071517 -0.0007779 0.00021618
                                593.628           0.00961737 -0.00352108 -0.00375042 0.00105697
                                226.2054          0.03724273 -0.01379065 -0.01516741 0.00418424
                                95.26145          0.11332297 -0.04331452 -0.04705206 0.01307817
                                42.8592           0.25335172 -0.10061222 -0.1152963 0.0309551
                                20.04971          0.38104215 -0.16161377 -0.17017078 0.04896849
                                9.620885          0.3070325 -0.11214083 -0.1322083 0.03516849
                                4.541371          0.08654534 0.18501865 0.53797582 -0.08338612
                                2.1135            0.00359924 0.4789308 0.61199701 -0.17709305
                                0.947201          0.00144059 0.40514792 -0.64465308 -0.11907766
                                0.391243          -0.00029901 0.0987216 -0.61225551 0.12237413
                                0.156497          0.00020351 -0.00148592 0.10798966 0.5499813
                                0.062599          -9.626e-05 0.00222977 0.37358045 0.39970337
                                0.02504           2.881e-05 -0.00072259 0.1878287 0.08298275
[INPUT] 2    0    [10   /2   ]  217.3688          0.00096699 -0.00098327
                                64.99976          0.00793294 -0.00789694
                                24.77314          0.03548314 -0.0364479
                                10.43614          0.10769519 -0.10760712
                                4.679653          0.22555488 -0.26104796
                                2.125622          0.31942979 -0.29085509
                                0.945242          0.3235439 0.01254821
                                0.402685          0.2433827 0.40386046
                                0.156651          0.10680569 0.38672483
                                0.06266           0.02052711 0.243945
[INPUT] 3    0    [6    /1   ]  11.2749           0.03802196
                                4.469             0.25501829
                                1.7713            0.50897998
                                0.7021            0.35473516
                                0.2783            0.12763297
                                0.1103            0.01946831
[INPUT] S
[INPUT] 0    0    [17   /4   ]  346348.23         0.00029092 -8.101e-05 2.28e-05 -2.342e-05
                                49391.146         0.00094665 -0.00026388 7.421e-05 -7.637e-05
                                14610.99          0.00211923 -0.00059263 0.00016719 -0.00017089
                                5187.2095         0.00602161 -0.00168762 0.00047372 -0.00048999
                                1980.9676         0.01659726 -0.00470357 0.00133106 -0.00135293
                                784.63139         0.04683989 -0.01350607 0.00379801 -0.0039282
                                317.32779         0.12242581 -0.03711959 0.01058108 -0.01067637
                                130.01976         0.27022435 -0.09114723 0.0260197 -0.02661813
                                53.738208         0.40541657 -0.17780418 0.05279001 -0.05183027
                                22.345896         0.25571527 -0.17069592 0.05191878 -0.05362245
                                9.3332512         0.02671693 0.17423163 -0.05692828 0.07080611
                                3.9111868         0.00390332 0.63283682 -0.2909519 0.28624981
                                1.6432066         -0.00204189 0.35886635 -0.31632828 0.49626307
                                0.6917456         0.00149034 -0.00096444 0.29309938 -1.07109282
                                0.2916736         -0.00062107 0.00659942 0.66787427 -0.7920747
                                0.1231441         0.00044167 -0.00522266 0.28725199 1.19881853
                                0.0492576         -3.24e-06 0.00029385 0.01516887 0.3247575
[INPUT] 1    0    [12   /3   ]  1129.1269         0.00090586 -0.00022454 0.00021481
                                274.03515         0.00600033 -0.0014885 0.00137868
                                97.402584         0.02531166 -0.00634942 0.00612706
                                38.085518         0.09198941 -0.02344282 0.02170457
                                15.471033         0.24165028 -0.06370257 0.06243734
                                6.405659          0.41029096 -0.11197083 0.10108619
                                2.6812828         0.35219287 -0.10347278 0.11708231
                                1.130005          0.08281645 0.10903888 -0.16261828
                                0.4783995         9.28e-05 0.41838741 -0.66461283
                                0.2031805         -0.00223897 0.43694091 -0.00256719
                                0.0864923         -0.0013105 0.18619701 0.71028173
                                0.0345969         -0.00022092 0.02837119 0.32134414
[INPUT] 2    0    [5    /1   ]  3.0053679         0.035815
                                1.2172976         0.16734186
                                0.4930556         0.57605251
                                0.1997078         0.35014066
                                0.0798831         0.04467461
[INPUT] C
[INPUT] 0    0    [14   /3   ]  50557.501         0.0001128874 -2.50742e-05 1.61788e-05
                                7524.7856         0.0005295373 -0.0001175945 7.49712e-05
                                1694.3276         0.0024500383 -0.0005456275 0.0003573467
                                472.82279         0.0100539847 -0.0022450771 0.0014349316
                                151.71075         0.0354539806 -0.0080434718 0.0055086779
                                53.918746         0.1044071086 -0.0244258871 0.016914969
                                20.659311         0.2412894918 -0.0613679118 0.0514166524
                                8.383976          0.3834225483 -0.1177767835 0.1137343741
                                3.577015          0.3078514393 -0.1550487783 0.2337183944
                                1.547118          0.0687244299 -0.0193331686 -0.0718378257
                                0.613013          0.0002224445 0.3996930678 -1.0490908711
                                0.246068          0.0019767489 0.5589420949 -0.0666273399
                                0.099087          0.0020578594 0.1711195023 1.0119993798
                                0.03468           0.000418202 0.0074562446 0.1656046386
[INPUT] 1    0    [9    /2   ]  83.333155         0.001344656 -0.0017715885
                                19.557611         0.010235555 -0.014562181
                                6.080365          0.045200671 -0.0574573357
                                2.179317          0.1410756198 -0.2126582848
                                0.86515           0.3047388085 -0.5271712924
                                0.361944          0.3995281011 -0.092969773
                                0.15474           0.2719163432 0.6630031669
                                0.065429          0.0585766933 0.3360877793
                                0.0229            -0.0001263813 0.0054695244
[INPUT] 2    0    [4    /1   ]  1.9               0.1424518048
                                0.665             0.5591973019
                                0.23275           0.443000438
                                0.081463          0.041066537
[INPUT] H
[INPUT] 0    0    [8    /2   ]  188.61445         0.00096385 -0.0013119
                                28.276596         0.00749196 -0.0103451
                                6.42483           0.03759541 -0.0504953
                                1.815041          0.14339498 -0.2073855
                                0.591063          0.3486363 -0.4350885
                                0.212149          0.43829736 -0.0247297
                                0.079891          0.16510661 0.32252599
                                0.027962          0.02102287 0.70727538
[INPUT] 1    0    [4    /1   ]  2.305             0.11279019
                                0.80675           0.41850753
                                0.282362          0.47000773
                                0.098827          0.18262603

nuclear repulsion = 2267.48682530826
point group symmetry = C1
symmetry origin: [0. 0. 0.]
symmetry axis x: [1. 0. 0.]
symmetry axis y: [0. 1. 0.]
symmetry axis z: [0. 0. 1.]
num. orbitals of irrep A = 292
number of shells = 62
number of NR pGTOs = 1268
number of NR cGTOs = 292
basis = {'Fe': [[0, [4316265.0, 0.00015003, -4.622e-05, 1.71e-05, -3.53e-06, 4.23e-06], [646342.4, 0.00043597, -0.00013445, 4.975e-05, -1.026e-05, 1.234e-05], [147089.7, 0.00120365, -0.00037184, 0.00013758, -2.838e-05, 3.4e-05], [41661.52, 0.00312635, -0.00096889, 0.00035879, -7.397e-05, 8.934e-05], [13590.77, 0.00814591, -0.00253948, 0.00094021, -0.0001941, 0.00023098], [4905.75, 0.02133892, -0.00673001, 0.0024986, -0.00051496, 0.00062709], [1912.746, 0.05470838, -0.0176816, 0.00657103, -0.00135801, 0.00160135], [792.6043, 0.12845394, -0.0437541, 0.01640473, -0.00338297, 0.00416181], [344.8065, 0.25203824, -0.09601111, 0.03637157, -0.00754121, 0.00877359], [155.8999, 0.35484986, -0.16998599, 0.06664937, -0.01380066, 0.01738346], [72.23091, 0.27043078, -0.18456376, 0.07553682, -0.01588736, 0.01718943], [32.72506, 0.06476086, 0.058263, -0.02586806, 0.00570363, -0.00196602], [15.66762, -0.00110466, 0.52163758, -0.3123023, 0.06807261, -0.09285258], [7.503483, 0.00184555, 0.49331062, -0.44997654, 0.10526256, -0.113506], [3.312223, -0.000856, 0.0863267, 0.14773374, -0.04562463, 0.01812457], [1.558471, 0.00037119, -0.00285017, 0.72995709, -0.21341607, 0.41268036], [0.683914, -0.00014687, 0.00165569, 0.38458847, -0.24353659, 0.10339104], [0.146757, 6.097e-05, -0.00049176, 0.0158289, 0.34358715, -0.89083095], [0.070583, -5.789e-05, 0.00047608, -0.00949537, 0.46401833, -0.80961283], [0.031449, 2.77e-05, -0.0002282, 0.00308038, 0.34688312, 1.52308946], [0.01258, -7.22e-06, 6.297e-05, -0.00100526, 0.01225841, 0.09142619]], [1, [7721.489, 0.00035287, -0.00012803, -0.00013663, 3.845e-05], [1829.126, 0.00196928, -0.00071517, -0.0007779, 0.00021618], [593.628, 0.00961737, -0.00352108, -0.00375042, 0.00105697], [226.2054, 0.03724273, -0.01379065, -0.01516741, 0.00418424], [95.26145, 0.11332297, -0.04331452, -0.04705206, 0.01307817], [42.8592, 0.25335172, -0.10061222, -0.1152963, 0.0309551], [20.04971, 0.38104215, -0.16161377, -0.17017078, 0.04896849], [9.620885, 0.3070325, -0.11214083, -0.1322083, 0.03516849], [4.541371, 0.08654534, 0.18501865, 0.53797582, -0.08338612], [2.1135, 0.00359924, 0.4789308, 0.61199701, -0.17709305], [0.947201, 0.00144059, 0.40514792, -0.64465308, -0.11907766], [0.391243, -0.00029901, 0.0987216, -0.61225551, 0.12237413], [0.156497, 0.00020351, -0.00148592, 0.10798966, 0.5499813], [0.062599, -9.626e-05, 0.00222977, 0.37358045, 0.39970337], [0.02504, 2.881e-05, -0.00072259, 0.1878287, 0.08298275]], [2, [217.3688, 0.00096699, -0.00098327], [64.99976, 0.00793294, -0.00789694], [24.77314, 0.03548314, -0.0364479], [10.43614, 0.10769519, -0.10760712], [4.679653, 0.22555488, -0.26104796], [2.125622, 0.31942979, -0.29085509], [0.945242, 0.3235439, 0.01254821], [0.402685, 0.2433827, 0.40386046], [0.156651, 0.10680569, 0.38672483], [0.06266, 0.02052711, 0.243945]], [3, [11.2749, 0.03802196], [4.469, 0.25501829], [1.7713, 0.50897998], [0.7021, 0.35473516], [0.2783, 0.12763297], [0.1103, 0.01946831]]], 'S': [[0, [346348.23, 0.00029092, -8.101e-05, 2.28e-05, -2.342e-05], [49391.146, 0.00094665, -0.00026388, 7.421e-05, -7.637e-05], [14610.99, 0.00211923, -0.00059263, 0.00016719, -0.00017089], [5187.2095, 0.00602161, -0.00168762, 0.00047372, -0.00048999], [1980.9676, 0.01659726, -0.00470357, 0.00133106, -0.00135293], [784.63139, 0.04683989, -0.01350607, 0.00379801, -0.0039282], [317.32779, 0.12242581, -0.03711959, 0.01058108, -0.01067637], [130.01976, 0.27022435, -0.09114723, 0.0260197, -0.02661813], [53.738208, 0.40541657, -0.17780418, 0.05279001, -0.05183027], [22.345896, 0.25571527, -0.17069592, 0.05191878, -0.05362245], [9.3332512, 0.02671693, 0.17423163, -0.05692828, 0.07080611], [3.9111868, 0.00390332, 0.63283682, -0.2909519, 0.28624981], [1.6432066, -0.00204189, 0.35886635, -0.31632828, 0.49626307], [0.6917456, 0.00149034, -0.00096444, 0.29309938, -1.07109282], [0.2916736, -0.00062107, 0.00659942, 0.66787427, -0.7920747], [0.1231441, 0.00044167, -0.00522266, 0.28725199, 1.19881853], [0.0492576, -3.24e-06, 0.00029385, 0.01516887, 0.3247575]], [1, [1129.1269, 0.00090586, -0.00022454, 0.00021481], [274.03515, 0.00600033, -0.0014885, 0.00137868], [97.402584, 0.02531166, -0.00634942, 0.00612706], [38.085518, 0.09198941, -0.02344282, 0.02170457], [15.471033, 0.24165028, -0.06370257, 0.06243734], [6.405659, 0.41029096, -0.11197083, 0.10108619], [2.6812828, 0.35219287, -0.10347278, 0.11708231], [1.130005, 0.08281645, 0.10903888, -0.16261828], [0.4783995, 9.28e-05, 0.41838741, -0.66461283], [0.2031805, -0.00223897, 0.43694091, -0.00256719], [0.0864923, -0.0013105, 0.18619701, 0.71028173], [0.0345969, -0.00022092, 0.02837119, 0.32134414]], [2, [3.0053679, 0.035815], [1.2172976, 0.16734186], [0.4930556, 0.57605251], [0.1997078, 0.35014066], [0.0798831, 0.04467461]]], 'C': [[0, [50557.501, 0.0001128874, -2.50742e-05, 1.61788e-05], [7524.7856, 0.0005295373, -0.0001175945, 7.49712e-05], [1694.3276, 0.0024500383, -0.0005456275, 0.0003573467], [472.82279, 0.0100539847, -0.0022450771, 0.0014349316], [151.71075, 0.0354539806, -0.0080434718, 0.0055086779], [53.918746, 0.1044071086, -0.0244258871, 0.016914969], [20.659311, 0.2412894918, -0.0613679118, 0.0514166524], [8.383976, 0.3834225483, -0.1177767835, 0.1137343741], [3.577015, 0.3078514393, -0.1550487783, 0.2337183944], [1.547118, 0.0687244299, -0.0193331686, -0.0718378257], [0.613013, 0.0002224445, 0.3996930678, -1.0490908711], [0.246068, 0.0019767489, 0.5589420949, -0.0666273399], [0.099087, 0.0020578594, 0.1711195023, 1.0119993798], [0.03468, 0.000418202, 0.0074562446, 0.1656046386]], [1, [83.333155, 0.001344656, -0.0017715885], [19.557611, 0.010235555, -0.014562181], [6.080365, 0.045200671, -0.0574573357], [2.179317, 0.1410756198, -0.2126582848], [0.86515, 0.3047388085, -0.5271712924], [0.361944, 0.3995281011, -0.092969773], [0.15474, 0.2719163432, 0.6630031669], [0.065429, 0.0585766933, 0.3360877793], [0.0229, -0.0001263813, 0.0054695244]], [2, [1.9, 0.1424518048], [0.665, 0.5591973019], [0.23275, 0.443000438], [0.081463, 0.041066537]]], 'H': [[0, [188.61445, 0.00096385, -0.0013119], [28.276596, 0.00749196, -0.0103451], [6.42483, 0.03759541, -0.0504953], [1.815041, 0.14339498, -0.2073855], [0.591063, 0.3486363, -0.4350885], [0.212149, 0.43829736, -0.0247297], [0.079891, 0.16510661, 0.32252599], [0.027962, 0.02102287, 0.70727538]], [1, [2.305, 0.11279019], [0.80675, 0.41850753], [0.282362, 0.47000773], [0.098827, 0.18262603]]]}
ecp = {}
CPU time:         2.29
[[ 2.26775765e-06  9.99643683e-01 -9.54521344e-06 ...  4.76761888e-04
  -2.86406652e-05  7.49284465e-05]
 [ 1.62376006e-05 -2.99415484e-04 -6.89081740e-05 ...  3.48100157e-03
  -1.85205016e-04  5.18395661e-04]
 [ 7.92247388e-05 -2.66810003e-02 -3.27178784e-04 ...  1.85420391e-02
  -2.38428227e-04  1.84710616e-03]
 ...
 [-2.73228933e-06  1.91065905e-06  5.74480140e-06 ... -6.08985450e-05
  -1.45530924e-03 -1.55265176e-03]
 [ 7.91243212e-06 -4.02087503e-06 -6.77702475e-06 ... -1.03525347e-04
   2.10685541e-03  1.00834997e-03]
 [ 2.30823231e-06 -4.71169891e-07  8.95300186e-07 ...  1.03139761e-04
   6.11319471e-04  1.37618634e-04]]
    CPU time for init_direct_scf      5.55 sec, wall time      0.46 sec
    CPU time for vj and vk   1690.86 sec, wall time    143.88 sec
MO integrals int2e_sph are saved in <HDF5 file "tmph6rtcslq" (mode r+)>/eri_mo
num. MO ints = 8281, required disk 0.066248 MB
step1: tmpfile /tmp/tmpdyytkmuc  31.142384 MB
step1: (ij,kl) = (91,42778), mem cache 4000 MB, iobuf 800 MB
    CPU time for Initializing ao2mo.outcore.half_e1      5.00 sec, wall time      0.43 sec
    CPU time for AO->MO transformation for int2e_sph 1 pass   3466.90 sec, wall time    332.52 sec
step2: kl-pair (ao 42778, mo 91), mem 54.75584 MB, ioblock 0.11648 MB
    CPU time for AO->MO transformation for int2e_sph 2 pass      2.32 sec, wall time      0.20 sec
    CPU time for AO->MO transformation for int2e_sph    3469.22 sec, wall time    332.72 sec
